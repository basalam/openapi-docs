<link rel="stylesheet" href="./assets/fonts/Estedad-stylesheet.css" />


<p align="center">
  <svg width="70" fill="currentColor" viewBox="0 0 71 50" xmlns="http://www.w3.org/2000/svg"><path d="M46.2752 47.5265L42.8338 41.1055L41.0336 41.5265L40.9277 48.7897C40.9277 49.2107 41.2454 49.5791 41.7219 49.5791C42.1455 49.5791 42.5161 49.2107 42.5161 48.7897V48.1581L44.581 47.6844L44.8457 48.2107C45.0575 48.5792 45.534 48.737 45.9046 48.5265C46.3282 48.4213 46.487 47.9476 46.2752 47.5265ZM42.569 46.6318L42.622 44.0528L43.8397 46.316L42.569 46.6318Z"></path><path d="M55.6986 43.1054L52.0454 36.8423L50.6688 37.6318L51.463 42.1581L47.9157 39.2107L46.5391 40.0002L50.1923 46.2633C50.3512 46.5265 50.6159 46.6318 50.8806 46.6318C51.0394 46.6318 51.1453 46.5791 51.3042 46.5265C51.6748 46.316 51.8336 45.8423 51.5689 45.4739L50.2452 43.1581L52.0983 44.6844L53.422 43.9475L52.9984 41.5791L54.3221 43.8949C54.5338 44.2633 55.0104 44.4212 55.381 44.1581C55.8045 43.9475 55.9634 43.4739 55.6986 43.1054Z"></path><path d="M36.3205 48.4213H33.938V42.1055H32.3496V50.0002H36.3205C36.7441 50.0002 37.1147 49.6318 37.1147 49.2107C37.1147 48.7897 36.7441 48.4213 36.3205 48.4213Z"></path><path d="M26.0496 40.4214L22.0786 46.5266C21.8669 46.8951 21.9728 47.3688 22.3434 47.6319C22.714 47.8424 23.1905 47.7372 23.4552 47.3688L23.7729 46.8424L25.7848 47.5267L25.7319 48.1582C25.679 48.5793 26.0496 48.9477 26.4732 49.0003H26.5261C26.9496 49.0003 27.2673 48.6845 27.3203 48.2635L27.7968 41.0003L26.0496 40.4214ZM24.673 45.5267L26.1025 43.3688L25.9437 45.9477L24.673 45.5267Z"></path><path d="M16.7307 44.3162C16.3071 44.3162 15.8306 44.2109 15.46 43.9478C14.454 43.2636 14.1893 41.8425 14.8776 40.8425C15.1423 40.4741 15.6188 40.3688 15.9894 40.632C16.3601 40.8951 16.466 41.3688 16.2012 41.7372C15.9895 42.053 16.0953 42.4214 16.3601 42.632C16.6777 42.8425 17.0484 42.7372 17.2601 42.4741L17.4719 42.1583C17.6837 41.8425 17.5778 41.4741 17.3131 41.2635C16.8366 40.9478 16.466 40.4214 16.3601 39.8425C16.2542 39.2635 16.3601 38.6846 16.7307 38.1583L16.9425 37.8425C17.2602 37.3688 17.7896 37.0004 18.372 36.8951C18.9544 36.7899 19.5368 36.8951 20.0663 37.2636C20.5428 37.5793 20.9134 38.1057 21.0193 38.6846C21.1252 39.2636 21.0193 39.8425 20.6487 40.3688C20.3839 40.7372 19.9074 40.8425 19.5368 40.5793C19.1662 40.3162 19.0603 39.8425 19.325 39.4741C19.4309 39.3162 19.4838 39.1583 19.4309 39.0004C19.378 38.8425 19.325 38.6846 19.1662 38.5793C19.0073 38.4741 18.8485 38.4214 18.6897 38.4741C18.5308 38.5267 18.372 38.5793 18.2661 38.7372L18.0543 39.053C17.9484 39.2109 17.8955 39.3688 17.9484 39.5267C18.0014 39.6846 18.0543 39.8425 18.2132 39.9478C19.2191 40.632 19.4839 42.053 18.7956 43.053L18.5838 43.3688C18.1073 44.0004 17.419 44.3162 16.7307 44.3162Z"></path><path d="M64.1178 36.8419C65.2875 36.8419 66.2356 35.8993 66.2356 34.7366C66.2356 33.5739 65.2875 32.6313 64.1178 32.6313C62.9482 32.6313 62 33.5739 62 34.7366C62 35.8993 62.9482 36.8419 64.1178 36.8419Z"></path><path d="M65.7057 16.842V23.6841C65.7057 24.5788 65.0174 25.263 64.1173 25.263C63.2172 25.263 62.5289 24.5788 62.5289 23.6841V8.4209H57.2344V23.6841C57.2344 27.4735 60.3052 30.5262 64.1173 30.5262C67.9294 30.5262 71.0002 27.4735 71.0002 23.6841V16.842H65.7057Z"></path><path d="M49.8218 23.6841C49.8218 24.5788 49.1335 25.263 48.2334 25.263C47.3333 25.263 46.645 24.5788 46.645 23.6841V16.8419H41.3505V23.6841C41.3505 24.5788 40.6622 25.263 39.7621 25.263C38.862 25.263 38.1737 24.5788 38.1737 23.6841V16.8419H32.8792V19.8419C32.6674 19.2104 32.3497 18.6314 31.9791 18.1051L28.6965 13.4735L31.1849 9.89458L26.8434 6.89458L25.4139 8.89458L22.9784 5.4209L18.6368 8.4209L22.1842 13.4735L18.9015 18.1051C18.2662 18.9998 17.8956 19.9472 17.6838 20.9998C16.7308 17.9998 13.9247 15.7893 10.5891 15.7893C6.51231 15.7893 3.17673 19.1051 3.17673 23.1577C3.17673 24.2104 3.38849 25.263 3.81206 26.1577C1.5354 27.4209 0 29.8419 0 32.5788V34.6841H5.29456V32.5788C5.29456 31.4209 6.24758 30.4735 7.41238 30.4735H10.2714C10.3773 30.4735 10.4832 30.4735 10.5891 30.4735C14.0835 30.4735 17.0485 28.0525 17.7897 24.7893C18.7427 28.0525 21.8136 30.4735 25.4139 30.4735C28.9612 30.4735 31.9262 28.1577 32.9851 24.9998C33.6204 28.1051 36.4266 30.4735 39.7092 30.4735C41.2975 30.4735 42.78 29.9472 43.9448 28.9998C45.1096 29.8946 46.5921 30.4735 48.1805 30.4735C51.9925 30.4735 55.0634 27.4209 55.0634 23.6314V16.7893H49.7688V23.6841H49.8218ZM10.642 25.263H10.4832C9.37136 25.1577 8.52422 24.263 8.52422 23.1577C8.52422 21.9998 9.47724 21.0525 10.642 21.0525C11.8068 21.0525 12.7599 21.9998 12.7599 23.1577C12.7599 24.3156 11.8068 25.263 10.642 25.263ZM25.4668 25.263C24.0373 25.263 22.8195 24.0525 22.8195 22.6314C22.8195 22.1051 22.9784 21.5788 23.2961 21.1051L25.4668 18.0525L27.6376 21.1051C27.9552 21.5262 28.1141 22.0525 28.1141 22.6314C28.1141 24.0525 26.8963 25.263 25.4668 25.263Z"></path></svg>
</p>

# سلام ای.پی.آی

**[سلام ای.پی.آی (Basalam API)](https://developers.basalam.com)** مجموعه‌ای از api‌های سرویس‌های باسلام است که امکان دسترسی به سرویس‌های باسلام را برای شما فراهم می‌کند. به واسطه api‌های ارائه شده شما می‌توانید با استفاده از استاندارد OAuth2 به اطلاعات کاربران اعم از غرفه‌داران و مشتریان دسترسی پیدا کنید و برنامه‌های خود را بر پایه آنها توسعه دهید.

در این مستندات سعی شده است که توضیحات کاملی برای اتصال به api‌ها داده شود.

---

## فهرست مطالب

* شروع
  * [دریافت توکن](#-شروع-دریافت-توکن-کاربر)
  * [دریافت اطلاعات کاربر](#دریافت-اطلاعات-کاربر)
  * [لیست APIها](#لیست-apiها)

---

## 🚀 شروع (دریافت توکن کاربر)

ابتدا باید از [اینجا](https://developers.basalam.com/clients) یک کلاینت ایجاد کنید.
کلاینت همان برنامه‌ی مدنظر شما جهت پیاده سازی است: [(راهنما)](https://developers.basalam.com/authorization#%D8%A7%DB%8C%D8%AC%D8%A7%D8%AF-%DA%A9%D9%84%D8%A7%DB%8C%D9%86%D8%AA)

* روی دکمه **ایجاد کلاینت** کلیک کنید.
* **name:** نام کلاینت (برنامه) خود را وارد کنید.
* **redirect_url:** آدرسی از برنامهٔ شما که کاربر بعد از صدور (یا رد) اجازه‌های درخواستی به آن هدایت شود. [(توضیحات بیشتر)](https://developers.basalam.com/authorization#%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%AF%D8%B3%D8%AA%D8%B1%D8%B3%DB%8C-%D8%A7%D8%B2-%DA%A9%D8%A7%D8%B1%D8%A8%D8%B1)

بعد از ایجاد کلاینت خود، برای احراز هویت کاربران و گرفتن توکن کاربر لازم است دکمه ای در برنامه‌ی خود ایجاد کنید که کاربران را به لینکی با ساختار زیر هدایت میکند:

```
https://basalam.com/accounts/sso?client_id=[client_id]&scope=[scope]&redirect_uri=[client_redirect_uri]&state=[state]
```

* **client_id:** آی دی کلاینتی که ایجاد کردید. در [این صفحه](https://developers.basalam.com/clients) قابل مشاهده است.
* **scope:** رشته‌ای از [دسترسی‌های](https://developers.basalam.com/scopes) درخواستی که با کاما "," یا فاصله جدا شده‌اند.
* **redirect_uri:** آدرسی که کاربر بعد از اعطای دسترسی به آن هدایت می‌شود، این آدرس باید همان آدرسی باشد که در ایجاد کلاینت قرار داده‌اید.
* **state:** یک رشته دلخواه که در درخواست‌های بعدی به کلاینت شما ارسال می‌شود که براساس آن کاربر بعد از ورود موفق به صفحه‌ی خاصی از برنامه شما هدایت شود یا اکشن خاصی برای کاربر انجام شود. (این پارامتر اختیاری است)

در مرحله بعد که کاربر به لینک redirect_uri شما هدایت شد، اگر اجازه دسترسی را تایید کرده باشد دو پارامتر زیر برای شما ارسال می شود:

* **code:** کد یک‌بار مصرف ایجاد شده توسط سرویس احراز هویت به منظور دریافت توکن
* **state:** مقدار دلخواهی که در مرحله قبل ارسال کرده‌اید

حالا باید با استفاده از code دریافتی ریکوئستی به فرمت زیر ارسال کنید که توکن کاربر را دریافت کنید:

```bash
curl --request POST \
  --url https://auth.basalam.com/oauth/token \
  --header 'Content-Type: application/json' \
  --header 'Accept: application/json' \
  --data '{
        "grant_type" : "authorization_code",
        "client_id" : "[client_id]",
        "client_secret" : "[client_secret]",
        "redirect_uri" : "[redirect_uri]",
        "code" : "[code]"
}'
```

* **client_id:** آی دی کلاینتی که ایجاد کردید. در [این صفحه](https://developers.basalam.com/clients) قابل مشاهده است.
* **client_secret:** رمز اختصاص داده شده به کلاینت. در [این صفحه](https://developers.basalam.com/clients) قابل مشاهده است.
* **redirect_uri:** آدرسی که کاربر بعد از اعطای دسترسی به آن هدایت می‌شود، این آدرس باید همان آدرسی باشد که در ایجاد کلاینت قرار داده‌اید.
* **code:** کد یکبار مصرفی که به آدرس ریدارکت شما ارسال شده است.

در صورت صحیح بودن اطلاعات، پاسخ دریافتی به صورت زیر است:

```json
{
  "token_type": "Bearer",
  "expires_in": 31622400,
  "access_token": "...",
  "refresh_token": "..."
}
```

* **token_type:** نوع توکن برگشتی، که نوع Bearer هست.
* **expires_in:** زمان معتبر بودن توکن به ثانیه
* **access_token:** توکن کاربر
* **refresh_token:** توکنی برای دریافت توکن جدید زمانی که توکن کاربر منقضی شده

پس از دریافت توکن، آن را نزد خود ذخیره کنید و برای درخواست های بعدی آنرا در هدر Authorization ارسال کنید.
برای اطلاعات بیشتر [این صفحه](https://developers.basalam.com/authorization#%D9%85%D8%B1%D8%AD%D9%84%D9%87-%D8%B3%D9%88%D9%85-%D8%AF%D8%B1%DB%8C%D8%A7%D9%81%D8%AA-%D8%A7%D8%B7%D9%84%D8%A7%D8%B9%D8%A7%D8%AA-%DA%A9%D8%A7%D8%B1%D8%A8%D8%B1) را مشاهده کنید.

## دریافت اطلاعات کاربر

پس از دریافت توکن کاربر، اولین قدم این است که اطلاعات کاربر را دریافت کنید و موارد مورد نیاز مانند شناسه کاربر (id) و شناسه غرفه کاربر (vendor->id) را برای درخواست های بعدی ذخیره کنید:

```bash
curl --request GET \
  --url https://core.basalam.com/v3/users/me \
  --header 'Accept: application/json'
  --header 'Authorization: Bearer [TOKEN]'
```

بجای `[TOKEN]` باید توکن کاربر را که در مراحل قبل بعد از تایید دسترسی توسط کاربر دریافت کردید را قرار دهید.

نمونه ریسپانس:

```json
{
  "id": 0, # شناسه عددی کاربر
  "hash_id": "string", # شناسه هش کاربر
  "username": "string", # نام کاربری
  "name": "string", # نام کامل
  "avatar": { # آبجکت عکس پروفایل
    "id": 0, # کد فایل عکس
    "original": "string", # آدرس عکس در سایز اصلی
    "xs": "string", # آدرس عکس در سایز خیلی کوچک
    "sm": "string", # آدرس عکس در سایز اسمال
    "md": "string", # آدرس عکس در سایز مدیوم
    "lg": "string" # آدرس عکس در سایز لارج
  },
  "marked_type": {
    "name": "string",
    "value": 0,
    "description": "string"
  },
  "user_follower_count": 0,
  "user_following_count": 0,
  "gender": {
    "name": "string",
    "value": 0,
    "description": "string"
  },
  "bio": "string",
  "city": {
    "name": "string",
    "value": 0,
    "province": {
      "name": "string",
      "value": 0,
      "description": "string"
    }
  },
  "created_at": "string",
  "last_activity": "string",
  "referral_journey_enum": {
    "name": "string",
    "value": 0,
    "description": "string"
  },
  "is_banned_in_social": true,
  "ban_user": {},
  "vendor": {
    "id": 0,
    "identifier": "string",
    "title": "string",
    "description": "string",
    "is_active": true,
    "free_shipping_to_iran": 0,
    "free_shipping_to_same_city": 0,
    "worth_buy": "string",
    "created_at": "string",
    "activated_at": "string",
    "order_count": 0,
    "status": 0
  },
  "email": "string",
  "birthday": "string",
  "national_code": "string",
  "mobile": "string",
  "credit_card_number": "string",
  "credit_card_owner": "string",
  "foreign_citizen_code": "string",
  "user_sheba_number": "string",
  "user_sheba_owner": "string",
  "bank_information": "string",
  "bank_information_owner": "string",
  "info_verification_status": {
    "name": "string",
    "value": 0,
    "description": "string"
  },
  "referrer_user_id": 0
}
```

## لیست APIها

معماری باسلام براساس میکروسرویس است و هر بخش آن وبسرویس‌های مجزای خود را دارد که در لیست زیر دردسترس هستند:

* [Core (هسته)](https://developers.basalam.com/services#-%D9%87%D8%B3%D8%AA%D9%87-core)
* [Wallet (کیف پول)](https://developers.basalam.com/services#-%DA%A9%DB%8C%D9%81-%D9%BE%D9%88%D9%84-wallet)
* [Order (سفارش)](https://developers.basalam.com/services#-%D8%B3%D9%81%D8%A7%D8%B1%D8%B4-order)
* [Order Processing (رهگیری سفارش)](https://developers.basalam.com/services#-%D8%B1%D9%87%DA%AF%DB%8C%D8%B1%DB%8C-%D8%B3%D9%81%D8%A7%D8%B1%D8%B4-order-processing)
* [Search (جستجو)](https://developers.basalam.com/services#-%D8%AC%D8%B3%D8%AA%D8%AC%D9%88-search)

